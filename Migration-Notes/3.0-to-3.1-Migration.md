# 3.0 to 3.1 Migration Notes

These migration notes assumes that you are going from a stock Heat Clinic demo to the 3.1 demo. There might be addtional migration steps for your particular implementation of Broadleaf, please let us know on the [forums](http://forums.broadleafcommerce.com) or by submitting a pull request to this documentation site at [https://github.com/BroadleafCommerce/docs](https://github.com/BroadleafCommerce/docs).

This document also assumes that you are on the latest 3.0 GA patch version of Broadleaf (like 3.0.8-GA). If you have not upgraded your site to be on the latest 3.0 patch version, please do so before continuing and see the optional migration docs for each 3.0 patch version.

## Maven Updates
In the root `pom.xml`:

1. Update the `blc.version` property to `3.1.0-GA`:

    ```xml
    <blc.version>3.1.0-GA</blc.version>
    ```

2. Update the version of the `commons-dbcp` to `1.4`

   ```xml
   <groupId>commons-dbcp</groupId>
   <artifactId>commons-dbcp</artifactId>
   <version>1.4</version>
   <type>jar</type>
   <scope>compile</scope>
   ```

## Admin Updates

1. Add the admin.css file to the `blJsFileMap` bean, underneath the `admin.js` entry. This looks like:

    ```xml
    <bean id="blJsFileMap" class="org.springframework.beans.factory.config.MapFactoryBean">
        <property name="sourceMap">
            <map>
                <entry key="admin.js" value-ref="blJsFileList"/>
                <entry key="admin.css" value-ref="blCssFileList"/>
            </map>
        </property>  
    </bean>
    ```
    
    > Optional: since this no longer just represents JS files, you might want to rename this bean to something more appropriate like `blResourceFileMap`

2. Update the `mvc:resources` definitions in `applicationContext-servlet-admin` to take into account the fact that some resources have been moved to common. The final definition of these entries should look like:

    ```xml
    <mvc:resources order="-10" location="classpath:/open_admin_style/img/, classpath:/common_style/img/" mapping="/img/**" />
    <mvc:resources order="-10" location="classpath:/open_admin_style/fonts/, classpath:/common_style/fonts/" mapping="/fonts/**" />
    <mvc:resources order="-10" location="WEB-INF/favicon.ico" mapping="/favicon.ico" />
    <mvc:resources order="-10" location="WEB-INF/robots.txt" mapping="/robots.txt" />
    ```

## Core Updates

1. Remove the custom class transformer designed to fix the [max offer usage bug](https://github.com/BroadleafCommerce/BroadleafCommerce/issues/548). This will effect you only if you are on Broadleaf 3.0.6-GA and above. This is no longer necessary in 3.1.0-GA and above.
2. 

## Site Updates

1. Move the `blRequestFilter` and `blCustomerStateFilter` into the `blPostSecurityFilterChain` located in `applicationContext-filter.xml`. The final version of this looks like:

    ```xml
    <bean id="blPostSecurityFilterChain" class="org.springframework.security.web.FilterChainProxy">
        <sec:filter-chain-map request-matcher="ant">
            <sec:filter-chain pattern="/**" filters="
               blRequestFilter,
               blCustomerStateFilter,
               blURLHandlerFilter,
               blTranslationFilter,
               blCartStateFilter"/>
        </sec:filter-chain-map>
    </bean>
    ````
    
    You should also remove the `blRequestFilter` from the `blPreSecurityFilterChain` (also in `applicationContext-filter.xml`) and remove `blCustomerStateFilter` located within the `<sec:http>` element in `applicationContext-security.xml`.

2. Add the common fonts to `applicationContext-servlet.xml`:

    ```xml
    <mvc:resources order="-10" location="/img/, classpath:/common_style/img/" mapping="/img/**" />
    <mvc:resources order="-10" location="/fonts/, classpath:/common_style/fonts/" mapping="/fonts/**" />
    <mvc:resources order="-10" location="WEB-INF/favicon.ico" mapping="/favicon.ico" />
    ```

    > Note: this is likely an optional step and only required if you depend on Broadleaf's version of FontAwesome and JQuery UI icons.

3. The `blc:head` Thymeleaf processor is now deprecated with the upgrade to Thymeleaf 2.1. Replace all instances of code like:

    ```diff
    - <blc:head pageTitle="Account - Broadleaf Demo - Heat Clinic" />
    ```
    
    with the following:
    
    ```html
    <head th:include="/layout/partials/head (pageTitle='Account - Broadleaf Demo - Heat Clinic')"></head>
    ```
    
    The feature that allowed for parameterized includes (which eliminated the need for the head processor) is documented in the [Thymeleaf 2.1 docs](http://www.thymeleaf.org/whatsnew21.html#fsig)
    
4. Remove the custom `blUserDetailsService` definition from `applicationContext-security.xml. This has been replaced by a component in the framework:

    ```diff
    -    <sec:jdbc-user-service data-source-ref="webDS"
    -        id="blUserDetailsService"
    -        users-by-username-query="SELECT USER_NAME,PASSWORD,TRUE FROM BLC_CUSTOMER WHERE USER_NAME=?"
    -        authorities-by-username-query="SELECT c.USER_NAME,r.ROLE_NAME from BLC_CUSTOMER c
    -                                          JOIN BLC_CUSTOMER_ROLE cr ON c.CUSTOMER_ID = cr.CUSTOMER_ID
    -                                          JOIN BLC_ROLE r ON cr.ROLE_ID = r.ROLE_ID
    -                                          WHERE USER_NAME=?" />
    ```

### Optional Updates
#### Manage `robots.txt` and `sitemap.xml` via configuration files
The documentation for how to do this in 3.1 is located at [[SEO]]. You will need to add a `RobotsController` that extends from `BroadleafRobotsController` and a `SiteMapController` extending from `BroadleafSiteMapController`:

```java
@Controller
public class RobotsController extends BroadleafRobotsController {

    /**
     * Retrieves the robots.txt file     
     *  
     * @param request
     * @param response
     * @param model
     * @param fileName
     * @return
     */
    @RequestMapping(value = { "/robots.txt" })
    @ResponseBody
    public String getRobotsFile(HttpServletRequest request, HttpServletResponse response) {
        return super.getRobotsFile(request, response);
    }
}
```

```java
@Controller
public class SiteMapController extends BroadleafSiteMapController {
    
    /**
     * Retrieves a site map file
     * 
     * @param request
     * @param response
     * @param model
     * @param fileName
     * @return
     */
    @RequestMapping(value = { "/sitemap*.xml", "sitemap*.gz" })
    @ResponseBody
    public FileSystemResource retrieveSiteMapIndex(HttpServletRequest request, HttpServletResponse response)
            throws IOException {
        return super.retrieveSiteMapFile(request, response);
    }
}
```

This will also require you to remove the `/robots.txt` mapping from applicationContext-security.xml. Delete this line:

```diff
- <sec:http pattern="/robots.txt" security="none" />
```

### EHCache settings
#### New regions:
1. blProducts (ProductAttribute, ProductBundle, Product, Sku, ProductOptionValue, ProductOption, SkuAttribute, SkuBundleItem, SkuFee)
2. blCategories (Category, CategoryAttribute, CategoryProductXref, FeaturedProduct, CategorySearchFacet)
3. blOffers (Offer, OfferItem, OfferRule)
4. blCustomerElements (Customer)
5. blConfigurationModuleElements (retrieving subtypes of AbstractModuleConfiguration)
6. query.Offer (retrieving lists of offers via daos)

## REST API Updates
### New Methods
1. /cart/items/{itemId}/options

### Deleted methods
## Workflow Updates

## Thymeleaf 2.1 Updates
Braodleaf has changed the Thymeleaf version from 2.0 to 2.1. Depending on how many Thymeleaf processors you have in your codebase this migration step may vary. See the [Thymeleaf documentation site](http://www.thymeleaf.org/whatsnew21.html) for the changes. You might check [our migration to Thymeleaf 2.1](https://github.com/BroadleafCommerce/BroadleafCommerce/pull/504) for what we had to change in the framework.

## Payment Module and Checkout Form Updates
We have completely rewritten the way that payments are treated in Broadleaf. We are still in the process of updating some of our existing payment modules. If there is a payment module written by Broadleaf that you need and has not been updated to the new 3.1 standards, please let us know at info AT broadleafcommerce.com.

For more information on how to ensure that your payment module conforms to the new Broadleaf standards, see [[Checkout Page Design]] and [[Payment]]. You might also gain additional insight by looking at the null payment gateway module that we implemented within the 3.1 demo site.

## Additional Miscellaneous Items
1. The checkout confirmation email should be moved away from the order confirmation controller and instead should be an activity within the `blCheckoutWorkflow`
2. 

## Data Migration

In the 3.1 codebase, we've completely refactored the way Payments are structured and persisted, so there are some data migrations if you intend to migrate from an earlier version.

You can view the new [[Order Payment]] model in the [[Database Model]] of the docs.

In general, we've made the model more flexible in terms of how Payments and Transactions are structured when integrating with Third Party Payment Gateways. There are a lot of intricasies involved as each Payment Gateway handles communication and transactions differently, so it was imperative to come up with a standardized and flexible solution that can best handle most solutions. You can read more about what all was done in the [[Payment]] Refactoctoring section of the docs.

The new Payment Refactoring DROPS the following tables:

- `BLC_AMOUNT_ITEM`
- `BLC_ORDER_PAYMENT_DETAILS`
- `BLC_PAYINFO_ADDITIONAL_FIELDS`
- `BLC_PAYMENT_ADDITIONAL_FIELDS`

Each gateway implentation in the 3.0 and earlier codebases persisted data in several different ways into the `BLC_ORDER_PAYMENT_DETAILS`, `BLC_PAYINFO_ADDITIONAL_FIELDS`, `BLC_PAYMENT_ADDITIONAL_FIELDS` depending on your
Payment Gateway Implementation. So, in order to do data migration, some data analysis should be done in order to find the best mapping solution to the new tables.

The new tables include:

- `BLC_ORDER_PAYMENT_TRANSACTION`
- `BLC_TRANS_ADDITNL_FIELDS`

A good rule of thumb is that `BLC_ORDER_PAYMENT_DETAILS` -> `BLC_ORDER_PAYMENT_TRANSACTION` and both `BLC_PAYINFO_ADDITIONAL_FIELDS` and `BLC_PAYMENT_ADDITIONAL_FIELDS` are part of the response map associated with a particuar `BLC_ORDER_PAYMENT_TRANSACTION` in the `BLC_TRANS_ADDITNL_FIELDS` table.


## Database Changes

There are several DB changes related to the 3.0 to 3.1 upgrade. You can find the history of changes to the database in the [[Database Model]].

Here is an example script of the changes that need to be applied for 3.1.
You can run the following script AT YOUR OWN RISK to update your tables. Please note that this script does DROP tables as this was based off of a Liquibase changelog Database diff. You will need to read the data migration section above and appropriately migrate the data if necessary.

```sql
CREATE TABLE BLC_ADMIN_USER_ADDTL_FIELDS (ADMIN_USER_ID BIGINT(19) NOT NULL, FIELD_VALUE VARCHAR(255) NULL, FIELD_NAME VARCHAR(255) NOT NULL);

CREATE TABLE BLC_CAT_SITE_MAP_GEN_CFG (ENDING_DEPTH INT(10) NOT NULL, STARTING_DEPTH INT(10) NOT NULL, GEN_CONFIG_ID BIGINT(19) NOT NULL, ROOT_CATEGORY_ID BIGINT(19) NOT NULL);

CREATE TABLE BLC_CUST_SITE_MAP_GEN_CFG (GEN_CONFIG_ID BIGINT(19) NOT NULL);

CREATE TABLE BLC_ORDER_PAYMENT_TRANSACTION (PAYMENT_TRANSACTION_ID BIGINT(19) NOT NULL, TRANSACTION_AMOUNT DECIMAL(19, 2) NULL, ARCHIVED CHAR(1) NULL, CUSTOMER_IP_ADDRESS VARCHAR(255) NULL, DATE_RECORDED datetime NULL, RAW_RESPONSE LONGTEXT NULL, SUCCESS BIT(1) NULL, TRANSACTION_TYPE VARCHAR(255) NULL, ORDER_PAYMENT BIGINT(19) NOT NULL, PARENT_TRANSACTION BIGINT(19) NULL);

CREATE TABLE BLC_SANDBOX_MGMT (SANDBOX_MGMT_ID BIGINT(19) NOT NULL, SANDBOX_ID BIGINT(19) NOT NULL);

CREATE TABLE BLC_SITE_MAP_CFG (INDEXED_SITE_MAP_FILE_NAME VARCHAR(255) NULL, INDEXED_SITE_MAP_FILE_PATTERN VARCHAR(255) NULL, MAX_URL_ENTRIES_PER_FILE INT(10) NULL, SITE_MAP_FILE_NAME VARCHAR(255) NULL, MODULE_CONFIG_ID BIGINT(19) NOT NULL);

CREATE TABLE BLC_SITE_MAP_GEN_CFG (GEN_CONFIG_ID BIGINT(19) NOT NULL, CHANGE_FREQ VARCHAR(255) NOT NULL, DISABLED BIT(1) NOT NULL, GENERATOR_TYPE VARCHAR(255) NOT NULL, PRIORITY VARCHAR(255) NULL, MODULE_CONFIG_ID BIGINT(19) NOT NULL);

CREATE TABLE BLC_SITE_MAP_URL_ENTRY (URL_ENTRY_ID BIGINT(19) NOT NULL, CHANGE_FREQ VARCHAR(255) NOT NULL, LAST_MODIFIED datetime NOT NULL, LOCATION VARCHAR(255) NOT NULL, PRIORITY VARCHAR(255) NOT NULL, GEN_CONFIG_ID BIGINT(19) NOT NULL);

CREATE TABLE BLC_TRANS_ADDITNL_FIELDS (PAYMENT_TRANSACTION_ID BIGINT(19) NOT NULL, FIELD_VALUE LONGTEXT NULL, FIELD_NAME VARCHAR(255) NOT NULL);

ALTER TABLE BLC_ORDER_PAYMENT ADD ARCHIVED CHAR(1) NULL;

ALTER TABLE BLC_CATEGORY_PRODUCT_XREF ADD CATEGORY_PRODUCT_ID BIGINT(19) NOT NULL;

ALTER TABLE BLC_CATEGORY_XREF ADD CATEGORY_XREF_ID BIGINT(19) NOT NULL;

ALTER TABLE BLC_SANDBOX ADD COLOR VARCHAR(255) NULL;

ALTER TABLE BLC_PRODUCT ADD DEFAULT_SKU_ID BIGINT(19) NULL;

ALTER TABLE BLC_SANDBOX ADD DESCRIPTION VARCHAR(255) NULL;

ALTER TABLE BLC_FLD_DEF ADD ENUM_ID BIGINT(19) NULL;

ALTER TABLE BLC_PAGE ADD EXCLUDE_FROM_SITE_MAP BIT(1) NULL;

ALTER TABLE BLC_SYSTEM_PROPERTY ADD FRIENDLY_GROUP VARCHAR(255) NULL;

ALTER TABLE BLC_SYSTEM_PROPERTY ADD FRIENDLY_NAME VARCHAR(255) NULL;

ALTER TABLE BLC_SYSTEM_PROPERTY ADD FRIENDLY_TAB VARCHAR(255) NULL;

ALTER TABLE BLC_ORDER_PAYMENT ADD GATEWAY_TYPE VARCHAR(255) NULL;

ALTER TABLE BLC_SANDBOX ADD GO_LIVE_DATE datetime NULL;

ALTER TABLE BLC_CUSTOMER ADD IS_PREVIEW BIT(1) NULL;

ALTER TABLE BLC_ORDER ADD IS_PREVIEW BIT(1) NULL;

ALTER TABLE BLC_ORDER_PAYMENT ADD ORDER_PAYMENT_ID BIGINT(19) NOT NULL;

ALTER TABLE BLC_PAYMENT_LOG ADD ORDER_PAYMENT_REF_NUM VARCHAR(255) NULL;

ALTER TABLE BLC_ORDER_ITEM ADD PARENT_ORDER_ITEM_ID BIGINT(19) NULL;

ALTER TABLE BLC_SANDBOX ADD PARENT_SANDBOX_ID BIGINT(19) NULL;

ALTER TABLE BLC_PRODUCT_OPTION_XREF ADD PRODUCT_OPTION_XREF_ID BIGINT(19) NOT NULL;

ALTER TABLE BLC_SYSTEM_PROPERTY ADD PROPERTY_TYPE VARCHAR(255) NULL;

ALTER TABLE BLC_FLD_DEF ADD REQUIRED_FLAG BIT(1) NULL;

ALTER TABLE BLC_OFFER ADD REQUIRES_RELATED_TAR_QUAL BIT(1) NULL;

ALTER TABLE BLC_PRODUCT_OPTION ADD VALIDATION_STRATEGY_TYPE VARCHAR(255) NULL;

ALTER TABLE BLC_ORDER_PAYMENT ADD REFERENCE_NUMBER VARCHAR(255) NULL;

ALTER TABLE BLC_SANDBOX_MGMT ADD CONSTRAINT UK4845009FE52B6993 UNIQUE (SANDBOX_ID);

ALTER TABLE BLC_ADMIN_USER_ADDTL_FIELDS ADD PRIMARY KEY (ADMIN_USER_ID, FIELD_NAME);

ALTER TABLE BLC_CAT_SITE_MAP_GEN_CFG ADD PRIMARY KEY (GEN_CONFIG_ID);

ALTER TABLE BLC_CUST_SITE_MAP_GEN_CFG ADD PRIMARY KEY (GEN_CONFIG_ID);

ALTER TABLE BLC_ORDER_PAYMENT_TRANSACTION ADD PRIMARY KEY (PAYMENT_TRANSACTION_ID);

ALTER TABLE BLC_PRODUCT_OPTION_XREF ADD PRIMARY KEY (PRODUCT_OPTION_XREF_ID);

ALTER TABLE BLC_SANDBOX_MGMT ADD PRIMARY KEY (SANDBOX_MGMT_ID);

ALTER TABLE BLC_SITE_MAP_CFG ADD PRIMARY KEY (MODULE_CONFIG_ID);

ALTER TABLE BLC_SITE_MAP_GEN_CFG ADD PRIMARY KEY (GEN_CONFIG_ID);

ALTER TABLE BLC_SITE_MAP_URL_ENTRY ADD PRIMARY KEY (URL_ENTRY_ID);

ALTER TABLE BLC_TRANS_ADDITNL_FIELDS ADD PRIMARY KEY (PAYMENT_TRANSACTION_ID, FIELD_NAME);

ALTER TABLE BLC_CAT_SITE_MAP_GEN_CFG ADD CONSTRAINT FK1BA4E695C5F3D60 FOREIGN KEY (ROOT_CATEGORY_ID) REFERENCES BLC_CATEGORY (CATEGORY_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_CAT_SITE_MAP_GEN_CFG ADD CONSTRAINT FK1BA4E69BCAB9F56 FOREIGN KEY (GEN_CONFIG_ID) REFERENCES BLC_SITE_MAP_GEN_CFG (GEN_CONFIG_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_SITE_MAP_GEN_CFG ADD CONSTRAINT FK1D76000A340ED71 FOREIGN KEY (MODULE_CONFIG_ID) REFERENCES BLC_SITE_MAP_CFG (MODULE_CONFIG_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_TRANS_ADDITNL_FIELDS ADD CONSTRAINT FK376DDE4B9E955B1D FOREIGN KEY (PAYMENT_TRANSACTION_ID) REFERENCES BLC_ORDER_PAYMENT_TRANSACTION (PAYMENT_TRANSACTION_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_FLD_DEF ADD CONSTRAINT FK3FCB575E38D08AB5 FOREIGN KEY (ENUM_ID) REFERENCES BLC_DATA_DRVN_ENUM (ENUM_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_SANDBOX_MGMT ADD CONSTRAINT FK4845009F579FE59D FOREIGN KEY (SANDBOX_ID) REFERENCES BLC_SANDBOX (SANDBOX_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_PRODUCT ADD CONSTRAINT FK5B95B7C96D386535 FOREIGN KEY (DEFAULT_SKU_ID) REFERENCES BLC_SKU (SKU_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_CUST_SITE_MAP_GEN_CFG ADD CONSTRAINT FK67C0DBA0BCAB9F56 FOREIGN KEY (GEN_CONFIG_ID) REFERENCES BLC_SITE_MAP_GEN_CFG (GEN_CONFIG_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_SITE_MAP_CFG ADD CONSTRAINT FK7012930FC50D449 FOREIGN KEY (MODULE_CONFIG_ID) REFERENCES BLC_MODULE_CONFIGURATION (MODULE_CONFIG_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_ADMIN_USER_ADDTL_FIELDS ADD CONSTRAINT FK73274CDD46EBC38 FOREIGN KEY (ADMIN_USER_ID) REFERENCES BLC_ADMIN_USER (ADMIN_USER_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_ORDER_PAYMENT_TRANSACTION ADD CONSTRAINT FK86FDE7CE6A69DD9D FOREIGN KEY (ORDER_PAYMENT) REFERENCES BLC_ORDER_PAYMENT (ORDER_PAYMENT_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_ORDER_PAYMENT_TRANSACTION ADD CONSTRAINT FK86FDE7CEE1B66C71 FOREIGN KEY (PARENT_TRANSACTION) REFERENCES BLC_ORDER_PAYMENT_TRANSACTION (PAYMENT_TRANSACTION_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_ORDER_ITEM ADD CONSTRAINT FK9A2E704AB0B0D00A FOREIGN KEY (PARENT_ORDER_ITEM_ID) REFERENCES BLC_ORDER_ITEM (ORDER_ITEM_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_SANDBOX ADD CONSTRAINT FKDD37A9A174160452 FOREIGN KEY (PARENT_SANDBOX_ID) REFERENCES BLC_SANDBOX (SANDBOX_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

ALTER TABLE BLC_SITE_MAP_URL_ENTRY ADD CONSTRAINT FKE2004FED36AFE1EE FOREIGN KEY (GEN_CONFIG_ID) REFERENCES BLC_CUST_SITE_MAP_GEN_CFG (GEN_CONFIG_ID) ON UPDATE NO ACTION ON DELETE NO ACTION;

CREATE INDEX ORDERPAYMENT_REFERENCE_INDEX ON BLC_ORDER_PAYMENT(REFERENCE_NUMBER);

CREATE INDEX PAYMENTLOG_REFERENCE_INDEX ON BLC_PAYMENT_LOG(ORDER_PAYMENT_REFERENCE_NUMBER);

CREATE UNIQUE INDEX `PRIMARY` ON BLC_CATEGORY_PRODUCT_XREF(CATEGORY_PRODUCT_ID);

CREATE UNIQUE INDEX `PRIMARY` ON BLC_CATEGORY_XREF(CATEGORY_XREF_ID);

CREATE UNIQUE INDEX `PRIMARY` ON BLC_ORDER_PAYMENT(ORDER_PAYMENT_ID);

ALTER TABLE BLC_FLD_DEF DROP FOREIGN KEY FK3FCB575EFD2EA299;

ALTER TABLE BLC_SC_FLD DROP FOREIGN KEY FK621D7B9513D95585;

ALTER TABLE BLC_ORDER_PAYMENT_DETAILS DROP FOREIGN KEY FK6D3907323E2FC4F9;

ALTER TABLE BLC_ORDER_PAYMENT_DETAILS DROP FOREIGN KEY FK6D390732CE00A2EB;

ALTER TABLE BLC_SC DROP FOREIGN KEY FK74EEB716579FE59D;

ALTER TABLE BLC_SC DROP FOREIGN KEY FK74EEB716F9C4A5B;

ALTER TABLE BLC_PAYMENT_RESPONSE_ITEM DROP FOREIGN KEY FK807B8F323E2FC4F9;

ALTER TABLE BLC_PAYMENT_RESPONSE_ITEM DROP FOREIGN KEY FK807B8F327470F437;

ALTER TABLE BLC_PAYMENT_RESPONSE_ITEM DROP FOREIGN KEY FK807B8F32BE7DFC59;

ALTER TABLE BLC_PAGE_FLD DROP FOREIGN KEY FK86433AD4883C2667;

ALTER TABLE BLC_ORDER_PAYMENT DROP FOREIGN KEY FK9517A14FCA0B98E0;

ALTER TABLE BLC_ORDER_PAYMENT DROP FOREIGN KEY FK9517A14FD894CB5D;

ALTER TABLE BLC_STATIC_ASSET DROP FOREIGN KEY FK9875FB05579FE59D;

ALTER TABLE BLC_STATIC_ASSET DROP FOREIGN KEY FK9875FB05F9C4A5B;

ALTER TABLE BLC_SITE_SANDBOX DROP FOREIGN KEY FKAD4F7EF5579FE59D;

ALTER TABLE BLC_SITE_SANDBOX DROP FOREIGN KEY FKAD4F7EF5843A8B63;

ALTER TABLE SANDBOX_ITEM_ACTION DROP FOREIGN KEY FKB270D74A9797A024;

ALTER TABLE SANDBOX_ITEM_ACTION DROP FOREIGN KEY FKB270D74AFE239304;

ALTER TABLE BLC_AMOUNT_ITEM DROP FOREIGN KEY FKB98530944BC71D98;

ALTER TABLE BLC_PAYMENT_ADDITIONAL_FIELDS DROP FOREIGN KEY FKE3507032D956B1CC;

ALTER TABLE BLC_PAGE DROP FOREIGN KEY FKF41BEDD5579FE59D;

ALTER TABLE BLC_PAGE DROP FOREIGN KEY FKF41BEDD5F9C4A5B;

ALTER TABLE BLC_SITE DROP FOREIGN KEY FKF41D6A8D64EBCCE3;

ALTER TABLE BLC_PAYINFO_ADDITIONAL_FIELDS DROP FOREIGN KEY FKF9378B824BC71D98;

ALTER TABLE BLC_SYSTEM_PROPERTY DROP KEY PROPERTY_NAME_;

ALTER TABLE BLC_ORDER_PAYMENT DROP KEY UK9517A14FD790DEBD;

ALTER TABLE BLC_CUSTOMER DROP KEY key1;

DROP TABLE BLC_AMOUNT_ITEM;

DROP TABLE BLC_ORDER_PAYMENT_DETAILS;

DROP TABLE BLC_PAYINFO_ADDITIONAL_FIELDS;

DROP TABLE BLC_PAYMENT_ADDITIONAL_FIELDS;

DROP TABLE BLC_PAYMENT_RESPONSE_ITEM;

DROP TABLE BLC_SANDBOX_ACTION;

DROP TABLE BLC_SANDBOX_ITEM;

DROP TABLE BLC_SITE_SANDBOX;

DROP TABLE SANDBOX_ITEM_ACTION;

ALTER TABLE BLC_PAGE DROP COLUMN ARCHIVED_FLAG;

ALTER TABLE BLC_SC DROP COLUMN ARCHIVED_FLAG;

ALTER TABLE BLC_STATIC_ASSET DROP COLUMN ARCHIVED_FLAG;

ALTER TABLE BLC_ORDER_PAYMENT DROP COLUMN CUSTOMER_IP_ADDRESS;

ALTER TABLE BLC_ORDER_PAYMENT DROP COLUMN CUSTOMER_PAYMENT_ID;

ALTER TABLE BLC_PAGE DROP COLUMN DELETED_FLAG;

ALTER TABLE BLC_SC DROP COLUMN DELETED_FLAG;

ALTER TABLE BLC_STATIC_ASSET DROP COLUMN DELETED_FLAG;

ALTER TABLE BLC_FLD_DEF DROP COLUMN FLD_ENUM_ID;

ALTER TABLE BLC_PAGE DROP COLUMN LOCKED_FLAG;

ALTER TABLE BLC_SC DROP COLUMN LOCKED_FLAG;

ALTER TABLE BLC_STATIC_ASSET DROP COLUMN LOCKED_FLAG;

ALTER TABLE BLC_STATIC_ASSET DROP COLUMN ORIG_ASSET_ID;

ALTER TABLE BLC_SC DROP COLUMN ORIG_ITEM_ID;

ALTER TABLE BLC_PAGE DROP COLUMN ORIG_PAGE_ID;

ALTER TABLE BLC_PAGE DROP COLUMN ORIG_SANDBOX_ID;

ALTER TABLE BLC_SC DROP COLUMN ORIG_SANDBOX_ID;

ALTER TABLE BLC_STATIC_ASSET DROP COLUMN ORIG_SANDBOX_ID;

ALTER TABLE BLC_PAGE_FLD DROP COLUMN PAGE_ID;

ALTER TABLE BLC_ORDER_PAYMENT DROP COLUMN PAYMENT_ID;

ALTER TABLE BLC_PAYMENT_LOG DROP COLUMN PAYMENT_INFO_REFERENCE_NUMBER;

ALTER TABLE BLC_ORDER_PAYMENT DROP COLUMN PHONE_ID;

ALTER TABLE BLC_SITE DROP COLUMN PRODUCTION_SANDBOX_ID;

ALTER TABLE BLC_ORDER_PAYMENT DROP COLUMN REFERENCE_NUMBER;

ALTER TABLE BLC_PAGE DROP COLUMN SANDBOX_ID;

ALTER TABLE BLC_SC DROP COLUMN SANDBOX_ID;

ALTER TABLE BLC_STATIC_ASSET DROP COLUMN SANDBOX_ID;

ALTER TABLE BLC_SC_FLD DROP COLUMN SC_ID;

ALTER TABLE BLC_PRODUCT DROP COLUMN TAX_CODE;

DROP INDEX ASST_ARCHVD_FLG_INDX ON BLC_STATIC_ASSET;

DROP INDEX ASST_DLTD_FLG_INDX ON BLC_STATIC_ASSET;

DROP INDEX ASST_LCKD_FLG_INDX ON BLC_STATIC_ASSET;

DROP INDEX ORIG_ASSET_ID_INDX ON BLC_STATIC_ASSET;

DROP INDEX ORIG_PAGE_ID_INDX ON BLC_PAGE;

DROP INDEX PAGE_ARCHVD_FLG_INDX ON BLC_PAGE;

DROP INDEX PAGE_DLTD_FLG_INDX ON BLC_PAGE;

DROP INDEX PAGE_LCKD_FLG_INDX ON BLC_PAGE;

DROP INDEX PAYMENTLOG_REFERENCE_INDEX ON BLC_PAYMENT_LOG;

DROP INDEX `PRIMARY` ON BLC_CATEGORY_PRODUCT_XREF;

DROP INDEX `PRIMARY` ON BLC_CATEGORY_XREF;

DROP INDEX `PRIMARY` ON BLC_ORDER_PAYMENT;

DROP INDEX SC_ARCHVD_FLG_INDX ON BLC_SC;

DROP INDEX SC_DLTD_FLG_INDX ON BLC_SC;

DROP INDEX SC_LCKD_FLG_INDX ON BLC_SC;

DROP INDEX SC_ORIG_ITEM_ID_INDEX ON BLC_SC;

DROP INDEX STORE_CITY_INDEX ON BLC_STORE;

DROP INDEX STORE_COUNTRY_INDEX ON BLC_STORE;

DROP INDEX STORE_LATITUDE_INDEX ON BLC_STORE;

DROP INDEX STORE_LONGITUDE_INDEX ON BLC_STORE;

DROP INDEX STORE_NAME_INDEX ON BLC_STORE;

DROP INDEX STORE_STATE_INDEX ON BLC_STORE;

DROP INDEX STORE_ZIP_INDEX ON BLC_STORE;

ALTER TABLE BLC_CATEGORY_PRODUCT_XREF MODIFY DISPLAY_ORDER DECIMAL(10, 6);

ALTER TABLE BLC_CATEGORY_XREF MODIFY DISPLAY_ORDER DECIMAL(10, 6);

ALTER TABLE BLC_CAT_SEARCH_FACET_XREF MODIFY SEQUENCE DECIMAL(19, 2);

ALTER TABLE BLC_PRODUCT_CROSS_SALE MODIFY SEQUENCE DECIMAL(10, 6);

ALTER TABLE BLC_PRODUCT_FEATURED MODIFY SEQUENCE DECIMAL(10, 6);

ALTER TABLE BLC_PRODUCT_UP_SALE MODIFY SEQUENCE DECIMAL(10, 6);

ALTER TABLE BLC_STORE MODIFY STORE_ID BIGINT(19);

ALTER TABLE BLC_STORE MODIFY STORE_NAME VARCHAR(255) NOT NULL;

ALTER TABLE BLC_ADMIN_SECTION MODIFY USE_DEFAULT_HANDLER BIT(1) NULL;

ALTER TABLE BLC_CATEGORY_PRODUCT_XREF DROP PRIMARY KEY;

ALTER TABLE BLC_CATEGORY_PRODUCT_XREF ADD PRIMARY KEY (CATEGORY_PRODUCT_ID);

ALTER TABLE BLC_CATEGORY_XREF DROP PRIMARY KEY;

ALTER TABLE BLC_CATEGORY_XREF ADD PRIMARY KEY (CATEGORY_XREF_ID);

ALTER TABLE BLC_ORDER_PAYMENT DROP PRIMARY KEY;

ALTER TABLE BLC_ORDER_PAYMENT ADD PRIMARY KEY (ORDER_PAYMENT_ID);

```

Optionally, if you are using Liquibase, here is a DB changelog file that was generated that compares a 3.0.x schema to a 3.1.x schema. If you aren't using Liquibase, please consider using it and see our tutorial for more details: [[Managing DB Versions Migrations With Liquibase]]

```xml
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd">
    <changeSet author="liquibase (generated)" id="1390840028609-1">
        <createTable tableName="BLC_ADMIN_USER_ADDTL_FIELDS">
            <column name="ADMIN_USER_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="FIELD_VALUE" type="VARCHAR(255)"/>
            <column name="FIELD_NAME" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-2">
        <createTable tableName="BLC_CAT_SITE_MAP_GEN_CFG">
            <column name="ENDING_DEPTH" type="INT(10)">
                <constraints nullable="false"/>
            </column>
            <column name="STARTING_DEPTH" type="INT(10)">
                <constraints nullable="false"/>
            </column>
            <column name="GEN_CONFIG_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="ROOT_CATEGORY_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-3">
        <createTable tableName="BLC_CUST_SITE_MAP_GEN_CFG">
            <column name="GEN_CONFIG_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-4">
        <createTable tableName="BLC_ORDER_PAYMENT_TRANSACTION">
            <column name="PAYMENT_TRANSACTION_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="TRANSACTION_AMOUNT" type="DECIMAL(19, 2)"/>
            <column name="ARCHIVED" type="CHAR(1)"/>
            <column name="CUSTOMER_IP_ADDRESS" type="VARCHAR(255)"/>
            <column name="DATE_RECORDED" type="datetime"/>
            <column name="RAW_RESPONSE" type="LONGTEXT"/>
            <column name="SUCCESS" type="BIT(1)"/>
            <column name="TRANSACTION_TYPE" type="VARCHAR(255)"/>
            <column name="ORDER_PAYMENT" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="PARENT_TRANSACTION" type="BIGINT(19)"/>
        </createTable>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-5">
        <createTable tableName="BLC_SANDBOX_MGMT">
            <column name="SANDBOX_MGMT_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="SANDBOX_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-6">
        <createTable tableName="BLC_SITE_MAP_CFG">
            <column name="INDEXED_SITE_MAP_FILE_NAME" type="VARCHAR(255)"/>
            <column name="INDEXED_SITE_MAP_FILE_PATTERN" type="VARCHAR(255)"/>
            <column name="MAX_URL_ENTRIES_PER_FILE" type="INT(10)"/>
            <column name="SITE_MAP_FILE_NAME" type="VARCHAR(255)"/>
            <column name="MODULE_CONFIG_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-7">
        <createTable tableName="BLC_SITE_MAP_GEN_CFG">
            <column name="GEN_CONFIG_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="CHANGE_FREQ" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="DISABLED" type="BIT(1)">
                <constraints nullable="false"/>
            </column>
            <column name="GENERATOR_TYPE" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="PRIORITY" type="VARCHAR(255)"/>
            <column name="MODULE_CONFIG_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-8">
        <createTable tableName="BLC_SITE_MAP_URL_ENTRY">
            <column name="URL_ENTRY_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="CHANGE_FREQ" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="LAST_MODIFIED" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="LOCATION" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="PRIORITY" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="GEN_CONFIG_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-9">
        <createTable tableName="BLC_TRANS_ADDITNL_FIELDS">
            <column name="PAYMENT_TRANSACTION_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
            <column name="FIELD_VALUE" type="LONGTEXT"/>
            <column name="FIELD_NAME" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-10">
        <addColumn tableName="BLC_ORDER_PAYMENT">
            <column name="ARCHIVED" type="CHAR(1)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-11">
        <addColumn tableName="BLC_CATEGORY_PRODUCT_XREF">
            <column name="CATEGORY_PRODUCT_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-12">
        <addColumn tableName="BLC_CATEGORY_XREF">
            <column name="CATEGORY_XREF_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-13">
        <addColumn tableName="BLC_SANDBOX">
            <column name="COLOR" type="VARCHAR(255)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-14">
        <addColumn tableName="BLC_PRODUCT">
            <column name="DEFAULT_SKU_ID" type="BIGINT(19)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-15">
        <addColumn tableName="BLC_SANDBOX">
            <column name="DESCRIPTION" type="VARCHAR(255)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-16">
        <addColumn tableName="BLC_FLD_DEF">
            <column name="ENUM_ID" type="BIGINT(19)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-17">
        <addColumn tableName="BLC_PAGE">
            <column name="EXCLUDE_FROM_SITE_MAP" type="BIT"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-18">
        <addColumn tableName="BLC_SYSTEM_PROPERTY">
            <column name="FRIENDLY_GROUP" type="VARCHAR(255)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-19">
        <addColumn tableName="BLC_SYSTEM_PROPERTY">
            <column name="FRIENDLY_NAME" type="VARCHAR(255)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-20">
        <addColumn tableName="BLC_SYSTEM_PROPERTY">
            <column name="FRIENDLY_TAB" type="VARCHAR(255)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-21">
        <addColumn tableName="BLC_ORDER_PAYMENT">
            <column name="GATEWAY_TYPE" type="VARCHAR(255)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-22">
        <addColumn tableName="BLC_SANDBOX">
            <column name="GO_LIVE_DATE" type="DATETIME(19)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-23">
        <addColumn tableName="BLC_CUSTOMER">
            <column name="IS_PREVIEW" type="BIT"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-24">
        <addColumn tableName="BLC_ORDER">
            <column name="IS_PREVIEW" type="BIT"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-25">
        <addColumn tableName="BLC_ORDER_PAYMENT">
            <column name="ORDER_PAYMENT_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-26">
        <addColumn tableName="BLC_PAYMENT_LOG">
            <column name="ORDER_PAYMENT_REF_NUM" type="VARCHAR(255)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-27">
        <addColumn tableName="BLC_ORDER_ITEM">
            <column name="PARENT_ORDER_ITEM_ID" type="BIGINT(19)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-28">
        <addColumn tableName="BLC_SANDBOX">
            <column name="PARENT_SANDBOX_ID" type="BIGINT(19)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-29">
        <addColumn tableName="BLC_PRODUCT_OPTION_XREF">
            <column name="PRODUCT_OPTION_XREF_ID" type="BIGINT(19)">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-30">
        <addColumn tableName="BLC_SYSTEM_PROPERTY">
            <column name="PROPERTY_TYPE" type="VARCHAR(255)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-31">
        <addColumn tableName="BLC_FLD_DEF">
            <column name="REQUIRED_FLAG" type="BIT"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-32">
        <addColumn tableName="BLC_OFFER">
            <column name="REQUIRES_RELATED_TAR_QUAL" type="BIT"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-33">
        <addColumn tableName="BLC_PRODUCT_OPTION">
            <column name="VALIDATION_STRATEGY_TYPE" type="VARCHAR(255)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-34">
        <addColumn tableName="BLC_ORDER_PAYMENT">
            <column name="REFERENCE_NUMBER" type="VARCHAR(255)"/>
        </addColumn>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-35">
        <addUniqueConstraint columnNames="SANDBOX_ID" constraintName="UK4845009FE52B6993" deferrable="false" disabled="false" initiallyDeferred="false" tableName="BLC_SANDBOX_MGMT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-36">
        <addPrimaryKey columnNames="ADMIN_USER_ID, FIELD_NAME" constraintName="PRIMARY" tableName="BLC_ADMIN_USER_ADDTL_FIELDS"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-37">
        <addPrimaryKey columnNames="GEN_CONFIG_ID" constraintName="PRIMARY" tableName="BLC_CAT_SITE_MAP_GEN_CFG"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-38">
        <addPrimaryKey columnNames="GEN_CONFIG_ID" constraintName="PRIMARY" tableName="BLC_CUST_SITE_MAP_GEN_CFG"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-39">
        <addPrimaryKey columnNames="PAYMENT_TRANSACTION_ID" constraintName="PRIMARY" tableName="BLC_ORDER_PAYMENT_TRANSACTION"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-40">
        <addPrimaryKey columnNames="PRODUCT_OPTION_XREF_ID" constraintName="PRIMARY" tableName="BLC_PRODUCT_OPTION_XREF"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-41">
        <addPrimaryKey columnNames="SANDBOX_MGMT_ID" constraintName="PRIMARY" tableName="BLC_SANDBOX_MGMT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-42">
        <addPrimaryKey columnNames="MODULE_CONFIG_ID" constraintName="PRIMARY" tableName="BLC_SITE_MAP_CFG"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-43">
        <addPrimaryKey columnNames="GEN_CONFIG_ID" constraintName="PRIMARY" tableName="BLC_SITE_MAP_GEN_CFG"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-44">
        <addPrimaryKey columnNames="URL_ENTRY_ID" constraintName="PRIMARY" tableName="BLC_SITE_MAP_URL_ENTRY"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-45">
        <addPrimaryKey columnNames="PAYMENT_TRANSACTION_ID, FIELD_NAME" constraintName="PRIMARY" tableName="BLC_TRANS_ADDITNL_FIELDS"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-46">
        <addForeignKeyConstraint baseColumnNames="ROOT_CATEGORY_ID" baseTableName="BLC_CAT_SITE_MAP_GEN_CFG" constraintName="FK1BA4E695C5F3D60" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="CATEGORY_ID" referencedTableName="BLC_CATEGORY"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-47">
        <addForeignKeyConstraint baseColumnNames="GEN_CONFIG_ID" baseTableName="BLC_CAT_SITE_MAP_GEN_CFG" constraintName="FK1BA4E69BCAB9F56" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="GEN_CONFIG_ID" referencedTableName="BLC_SITE_MAP_GEN_CFG"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-48">
        <addForeignKeyConstraint baseColumnNames="MODULE_CONFIG_ID" baseTableName="BLC_SITE_MAP_GEN_CFG" constraintName="FK1D76000A340ED71" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="MODULE_CONFIG_ID" referencedTableName="BLC_SITE_MAP_CFG"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-49">
        <addForeignKeyConstraint baseColumnNames="PAYMENT_TRANSACTION_ID" baseTableName="BLC_TRANS_ADDITNL_FIELDS" constraintName="FK376DDE4B9E955B1D" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="PAYMENT_TRANSACTION_ID" referencedTableName="BLC_ORDER_PAYMENT_TRANSACTION"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-50">
        <addForeignKeyConstraint baseColumnNames="ENUM_ID" baseTableName="BLC_FLD_DEF" constraintName="FK3FCB575E38D08AB5" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ENUM_ID" referencedTableName="BLC_DATA_DRVN_ENUM"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-51">
        <addForeignKeyConstraint baseColumnNames="SANDBOX_ID" baseTableName="BLC_SANDBOX_MGMT" constraintName="FK4845009F579FE59D" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="SANDBOX_ID" referencedTableName="BLC_SANDBOX"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-52">
        <addForeignKeyConstraint baseColumnNames="DEFAULT_SKU_ID" baseTableName="BLC_PRODUCT" constraintName="FK5B95B7C96D386535" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="SKU_ID" referencedTableName="BLC_SKU"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-53">
        <addForeignKeyConstraint baseColumnNames="GEN_CONFIG_ID" baseTableName="BLC_CUST_SITE_MAP_GEN_CFG" constraintName="FK67C0DBA0BCAB9F56" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="GEN_CONFIG_ID" referencedTableName="BLC_SITE_MAP_GEN_CFG"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-54">
        <addForeignKeyConstraint baseColumnNames="MODULE_CONFIG_ID" baseTableName="BLC_SITE_MAP_CFG" constraintName="FK7012930FC50D449" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="MODULE_CONFIG_ID" referencedTableName="BLC_MODULE_CONFIGURATION"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-55">
        <addForeignKeyConstraint baseColumnNames="ADMIN_USER_ID" baseTableName="BLC_ADMIN_USER_ADDTL_FIELDS" constraintName="FK73274CDD46EBC38" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ADMIN_USER_ID" referencedTableName="BLC_ADMIN_USER"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-56">
        <addForeignKeyConstraint baseColumnNames="ORDER_PAYMENT" baseTableName="BLC_ORDER_PAYMENT_TRANSACTION" constraintName="FK86FDE7CE6A69DD9D" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ORDER_PAYMENT_ID" referencedTableName="BLC_ORDER_PAYMENT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-57">
        <addForeignKeyConstraint baseColumnNames="PARENT_TRANSACTION" baseTableName="BLC_ORDER_PAYMENT_TRANSACTION" constraintName="FK86FDE7CEE1B66C71" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="PAYMENT_TRANSACTION_ID" referencedTableName="BLC_ORDER_PAYMENT_TRANSACTION"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-58">
        <addForeignKeyConstraint baseColumnNames="PARENT_ORDER_ITEM_ID" baseTableName="BLC_ORDER_ITEM" constraintName="FK9A2E704AB0B0D00A" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="ORDER_ITEM_ID" referencedTableName="BLC_ORDER_ITEM"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-59">
        <addForeignKeyConstraint baseColumnNames="PARENT_SANDBOX_ID" baseTableName="BLC_SANDBOX" constraintName="FKDD37A9A174160452" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="SANDBOX_ID" referencedTableName="BLC_SANDBOX"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-60">
        <addForeignKeyConstraint baseColumnNames="GEN_CONFIG_ID" baseTableName="BLC_SITE_MAP_URL_ENTRY" constraintName="FKE2004FED36AFE1EE" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="GEN_CONFIG_ID" referencedTableName="BLC_CUST_SITE_MAP_GEN_CFG"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-61">
        <createIndex indexName="ORDERPAYMENT_REFERENCE_INDEX" tableName="BLC_ORDER_PAYMENT" unique="false">
            <column name="REFERENCE_NUMBER"/>
        </createIndex>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-62">
        <createIndex indexName="PAYMENTLOG_REFERENCE_INDEX" tableName="BLC_PAYMENT_LOG" unique="false">
            <column name="ORDER_PAYMENT_REFERENCE_NUMBER"/>
        </createIndex>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-63">
        <createIndex indexName="PRIMARY" tableName="BLC_CATEGORY_PRODUCT_XREF" unique="true">
            <column name="CATEGORY_PRODUCT_ID"/>
        </createIndex>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-64">
        <createIndex indexName="PRIMARY" tableName="BLC_CATEGORY_XREF" unique="true">
            <column name="CATEGORY_XREF_ID"/>
        </createIndex>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-65">
        <createIndex indexName="PRIMARY" tableName="BLC_ORDER_PAYMENT" unique="true">
            <column name="ORDER_PAYMENT_ID"/>
        </createIndex>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-66">
        <dropForeignKeyConstraint baseTableName="BLC_FLD_DEF" constraintName="FK3FCB575EFD2EA299"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-67">
        <dropForeignKeyConstraint baseTableName="BLC_SC_FLD" constraintName="FK621D7B9513D95585"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-68">
        <dropForeignKeyConstraint baseTableName="BLC_ORDER_PAYMENT_DETAILS" constraintName="FK6D3907323E2FC4F9"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-69">
        <dropForeignKeyConstraint baseTableName="BLC_ORDER_PAYMENT_DETAILS" constraintName="FK6D390732CE00A2EB"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-70">
        <dropForeignKeyConstraint baseTableName="BLC_SC" constraintName="FK74EEB716579FE59D"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-71">
        <dropForeignKeyConstraint baseTableName="BLC_SC" constraintName="FK74EEB716F9C4A5B"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-72">
        <dropForeignKeyConstraint baseTableName="BLC_PAYMENT_RESPONSE_ITEM" constraintName="FK807B8F323E2FC4F9"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-73">
        <dropForeignKeyConstraint baseTableName="BLC_PAYMENT_RESPONSE_ITEM" constraintName="FK807B8F327470F437"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-74">
        <dropForeignKeyConstraint baseTableName="BLC_PAYMENT_RESPONSE_ITEM" constraintName="FK807B8F32BE7DFC59"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-75">
        <dropForeignKeyConstraint baseTableName="BLC_PAGE_FLD" constraintName="FK86433AD4883C2667"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-76">
        <dropForeignKeyConstraint baseTableName="BLC_ORDER_PAYMENT" constraintName="FK9517A14FCA0B98E0"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-77">
        <dropForeignKeyConstraint baseTableName="BLC_ORDER_PAYMENT" constraintName="FK9517A14FD894CB5D"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-78">
        <dropForeignKeyConstraint baseTableName="BLC_STATIC_ASSET" constraintName="FK9875FB05579FE59D"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-79">
        <dropForeignKeyConstraint baseTableName="BLC_STATIC_ASSET" constraintName="FK9875FB05F9C4A5B"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-80">
        <dropForeignKeyConstraint baseTableName="BLC_SITE_SANDBOX" constraintName="FKAD4F7EF5579FE59D"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-81">
        <dropForeignKeyConstraint baseTableName="BLC_SITE_SANDBOX" constraintName="FKAD4F7EF5843A8B63"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-82">
        <dropForeignKeyConstraint baseTableName="SANDBOX_ITEM_ACTION" constraintName="FKB270D74A9797A024"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-83">
        <dropForeignKeyConstraint baseTableName="SANDBOX_ITEM_ACTION" constraintName="FKB270D74AFE239304"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-84">
        <dropForeignKeyConstraint baseTableName="BLC_AMOUNT_ITEM" constraintName="FKB98530944BC71D98"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-85">
        <dropForeignKeyConstraint baseTableName="BLC_PAYMENT_ADDITIONAL_FIELDS" constraintName="FKE3507032D956B1CC"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-86">
        <dropForeignKeyConstraint baseTableName="BLC_PAGE" constraintName="FKF41BEDD5579FE59D"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-87">
        <dropForeignKeyConstraint baseTableName="BLC_PAGE" constraintName="FKF41BEDD5F9C4A5B"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-88">
        <dropForeignKeyConstraint baseTableName="BLC_SITE" constraintName="FKF41D6A8D64EBCCE3"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-89">
        <dropForeignKeyConstraint baseTableName="BLC_PAYINFO_ADDITIONAL_FIELDS" constraintName="FKF9378B824BC71D98"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-90">
        <dropUniqueConstraint constraintName="PROPERTY_NAME_" tableName="BLC_SYSTEM_PROPERTY"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-91">
        <dropUniqueConstraint constraintName="UK9517A14FD790DEBD" tableName="BLC_ORDER_PAYMENT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-92">
        <dropUniqueConstraint constraintName="key1" tableName="BLC_CUSTOMER"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-93">
        <dropTable tableName="BLC_AMOUNT_ITEM"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-94">
        <dropTable tableName="BLC_ORDER_PAYMENT_DETAILS"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-95">
        <dropTable tableName="BLC_PAYINFO_ADDITIONAL_FIELDS"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-96">
        <dropTable tableName="BLC_PAYMENT_ADDITIONAL_FIELDS"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-97">
        <dropTable tableName="BLC_PAYMENT_RESPONSE_ITEM"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-98">
        <dropTable tableName="BLC_SANDBOX_ACTION"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-99">
        <dropTable tableName="BLC_SANDBOX_ITEM"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-100">
        <dropTable tableName="BLC_SITE_SANDBOX"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-101">
        <dropTable tableName="SANDBOX_ITEM_ACTION"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-102">
        <dropColumn columnName="ARCHIVED_FLAG" tableName="BLC_PAGE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-103">
        <dropColumn columnName="ARCHIVED_FLAG" tableName="BLC_SC"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-104">
        <dropColumn columnName="ARCHIVED_FLAG" tableName="BLC_STATIC_ASSET"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-105">
        <dropColumn columnName="CUSTOMER_IP_ADDRESS" tableName="BLC_ORDER_PAYMENT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-106">
        <dropColumn columnName="CUSTOMER_PAYMENT_ID" tableName="BLC_ORDER_PAYMENT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-107">
        <dropColumn columnName="DELETED_FLAG" tableName="BLC_PAGE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-108">
        <dropColumn columnName="DELETED_FLAG" tableName="BLC_SC"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-109">
        <dropColumn columnName="DELETED_FLAG" tableName="BLC_STATIC_ASSET"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-110">
        <dropColumn columnName="FLD_ENUM_ID" tableName="BLC_FLD_DEF"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-111">
        <dropColumn columnName="LOCKED_FLAG" tableName="BLC_PAGE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-112">
        <dropColumn columnName="LOCKED_FLAG" tableName="BLC_SC"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-113">
        <dropColumn columnName="LOCKED_FLAG" tableName="BLC_STATIC_ASSET"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-114">
        <dropColumn columnName="ORIG_ASSET_ID" tableName="BLC_STATIC_ASSET"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-115">
        <dropColumn columnName="ORIG_ITEM_ID" tableName="BLC_SC"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-116">
        <dropColumn columnName="ORIG_PAGE_ID" tableName="BLC_PAGE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-117">
        <dropColumn columnName="ORIG_SANDBOX_ID" tableName="BLC_PAGE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-118">
        <dropColumn columnName="ORIG_SANDBOX_ID" tableName="BLC_SC"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-119">
        <dropColumn columnName="ORIG_SANDBOX_ID" tableName="BLC_STATIC_ASSET"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-120">
        <dropColumn columnName="PAGE_ID" tableName="BLC_PAGE_FLD"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-121">
        <dropColumn columnName="PAYMENT_ID" tableName="BLC_ORDER_PAYMENT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-122">
        <dropColumn columnName="PAYMENT_INFO_REFERENCE_NUMBER" tableName="BLC_PAYMENT_LOG"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-123">
        <dropColumn columnName="PHONE_ID" tableName="BLC_ORDER_PAYMENT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-124">
        <dropColumn columnName="PRODUCTION_SANDBOX_ID" tableName="BLC_SITE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-125">
        <dropColumn columnName="REFERENCE_NUMBER" tableName="BLC_ORDER_PAYMENT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-126">
        <dropColumn columnName="SANDBOX_ID" tableName="BLC_PAGE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-127">
        <dropColumn columnName="SANDBOX_ID" tableName="BLC_SC"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-128">
        <dropColumn columnName="SANDBOX_ID" tableName="BLC_STATIC_ASSET"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-129">
        <dropColumn columnName="SC_ID" tableName="BLC_SC_FLD"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-130">
        <dropColumn columnName="TAX_CODE" tableName="BLC_PRODUCT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-131">
        <dropIndex indexName="ASST_ARCHVD_FLG_INDX" tableName="BLC_STATIC_ASSET"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-132">
        <dropIndex indexName="ASST_DLTD_FLG_INDX" tableName="BLC_STATIC_ASSET"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-133">
        <dropIndex indexName="ASST_LCKD_FLG_INDX" tableName="BLC_STATIC_ASSET"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-134">
        <dropIndex indexName="ORIG_ASSET_ID_INDX" tableName="BLC_STATIC_ASSET"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-135">
        <dropIndex indexName="ORIG_PAGE_ID_INDX" tableName="BLC_PAGE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-136">
        <dropIndex indexName="PAGE_ARCHVD_FLG_INDX" tableName="BLC_PAGE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-137">
        <dropIndex indexName="PAGE_DLTD_FLG_INDX" tableName="BLC_PAGE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-138">
        <dropIndex indexName="PAGE_LCKD_FLG_INDX" tableName="BLC_PAGE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-139">
        <dropIndex indexName="PAYMENTLOG_REFERENCE_INDEX" tableName="BLC_PAYMENT_LOG"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-140">
        <dropIndex indexName="PRIMARY" tableName="BLC_CATEGORY_PRODUCT_XREF"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-141">
        <dropIndex indexName="PRIMARY" tableName="BLC_CATEGORY_XREF"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-142">
        <dropIndex indexName="PRIMARY" tableName="BLC_ORDER_PAYMENT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-143">
        <dropIndex indexName="SC_ARCHVD_FLG_INDX" tableName="BLC_SC"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-144">
        <dropIndex indexName="SC_DLTD_FLG_INDX" tableName="BLC_SC"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-145">
        <dropIndex indexName="SC_LCKD_FLG_INDX" tableName="BLC_SC"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-146">
        <dropIndex indexName="SC_ORIG_ITEM_ID_INDEX" tableName="BLC_SC"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-147">
        <dropIndex indexName="STORE_CITY_INDEX" tableName="BLC_STORE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-148">
        <dropIndex indexName="STORE_COUNTRY_INDEX" tableName="BLC_STORE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-149">
        <dropIndex indexName="STORE_LATITUDE_INDEX" tableName="BLC_STORE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-150">
        <dropIndex indexName="STORE_LONGITUDE_INDEX" tableName="BLC_STORE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-151">
        <dropIndex indexName="STORE_NAME_INDEX" tableName="BLC_STORE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-152">
        <dropIndex indexName="STORE_STATE_INDEX" tableName="BLC_STORE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-153">
        <dropIndex indexName="STORE_ZIP_INDEX" tableName="BLC_STORE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-154">
        <modifyDataType columnName="DISPLAY_ORDER" newDataType="decimal(10,6)" tableName="BLC_CATEGORY_PRODUCT_XREF"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-155">
        <modifyDataType columnName="DISPLAY_ORDER" newDataType="decimal(10,6)" tableName="BLC_CATEGORY_XREF"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-156">
        <modifyDataType columnName="SEQUENCE" newDataType="decimal(19,2)" tableName="BLC_CAT_SEARCH_FACET_XREF"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-157">
        <modifyDataType columnName="SEQUENCE" newDataType="decimal(10,6)" tableName="BLC_PRODUCT_CROSS_SALE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-158">
        <modifyDataType columnName="SEQUENCE" newDataType="decimal(10,6)" tableName="BLC_PRODUCT_FEATURED"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-159">
        <modifyDataType columnName="SEQUENCE" newDataType="decimal(10,6)" tableName="BLC_PRODUCT_UP_SALE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-160">
        <modifyDataType columnName="STORE_ID" newDataType="bigint(19)" tableName="BLC_STORE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-161">
        <addNotNullConstraint columnDataType="varchar(255)" columnName="STORE_NAME" tableName="BLC_STORE"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-162">
        <dropNotNullConstraint columnDataType="boolean" columnName="USE_DEFAULT_HANDLER" tableName="BLC_ADMIN_SECTION"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-163">
        <dropPrimaryKey tableName="BLC_CATEGORY_PRODUCT_XREF"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-164">
        <addPrimaryKey columnNames="CATEGORY_PRODUCT_ID" constraintName="PRIMARY" tableName="BLC_CATEGORY_PRODUCT_XREF"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-165">
        <dropPrimaryKey tableName="BLC_CATEGORY_XREF"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-166">
        <addPrimaryKey columnNames="CATEGORY_XREF_ID" constraintName="PRIMARY" tableName="BLC_CATEGORY_XREF"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-167">
        <dropPrimaryKey tableName="BLC_ORDER_PAYMENT"/>
    </changeSet>
    <changeSet author="liquibase (generated)" id="1390840028609-168">
        <addPrimaryKey columnNames="ORDER_PAYMENT_ID" constraintName="PRIMARY" tableName="BLC_ORDER_PAYMENT"/>
    </changeSet>
</databaseChangeLog>
```

